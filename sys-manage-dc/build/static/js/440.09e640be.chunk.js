"use strict";(self.webpackChunksys_manage_dc=self.webpackChunksys_manage_dc||[]).push([[440],{1318:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Y});var n=i(5043),s=i(5444),a=i(6569),l=i(6651),r=i(6051),d=i(5206),o=i(1686),c=i(2294),h=i(8829),x=i(4434),p=i(1118),g=i(6399),m=i(5337),u=i(6091),y=i(6237),f=i(1210),A=i(3722),j=i(119),v=i(2156),b=i(5565),S=i(1334),w=i(8600),I=i(7534),N=i(6011),T=i(4471),C=i(7895),k=i(9002),B=i(3003),V=i(7885),D=i(5055),L=i(6863),q=i(5472),H=i(8205),M=i(3927),$=i(5531),z=i(5008),R=i(691),W=i(579);const{Text:P}=M.A,{useBreakpoint:F}=H.Ay,E=e=>{let{petId:t,petName:i,open:s,onCancel:a,onViewVaccinationDetail:l}=e;const[r,d]=(0,n.useState)([]),[c,x]=(0,n.useState)(!1),p=F(),m=e=>{if(!e||isNaN(e.getTime()))return(0,W.jsx)(P,{type:"secondary",children:"N/A"});const t=e.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}),i=e.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"});return(0,W.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,W.jsxs)("span",{children:[(0,W.jsx)(f.A,{style:{marginRight:6}}),(0,W.jsx)("strong",{children:t})]}),(0,W.jsx)(P,{type:"secondary",style:{marginLeft:24},children:i})]})};(0,n.useEffect)((()=>{let e;return s&&(()=>{try{x(!0),e=(0,q.aQ)((0,q.rJ)(L.db,"vaccinations"),(e=>{const i=[];e.forEach((e=>{const n=e.data(),s=n.createdAt,a=s instanceof q.Dc?s.toDate():new Date(s);Array.isArray(n.senderTo)&&n.senderTo.forEach((s=>{var l;const r=(null===(l=s.userId)||void 0===l?void 0:l.split("|"))||[];r[r.length-1]===t&&i.push({id:e.id,createdAt:a,userId:s.userId,vaccineType:n.vaccineType||"Kh\xf4ng r\xf5",status:s.status||"Pending"})}))})),d(i),x(!1)}))}catch(i){console.error("L\u1ed7i khi t\u1ea3i l\u1ecbch s\u1eed ti\xeam ph\xf2ng:",i),x(!1)}})(),()=>{e&&e()}}),[s,t]);return(0,W.jsx)(h.A,{title:`L\u1ecbch s\u1eed ti\xeam ph\xf2ng c\u1ee7a ${i}`,open:s,onCancel:a,footer:null,width:p.xs?"95vw":1200,style:{top:30,maxWidth:"100vw"},styles:{body:{maxHeight:"70vh",overflowY:"auto",padding:p.xs?"8px 12px":"12px 16px"}},children:(0,W.jsx)(o.A,{spinning:c,children:r.length>0?(0,W.jsx)(R.A,{bordered:!0,column:1,size:p.xs?"small":"middle",labelStyle:{width:p.xs?100:200},children:r.map((e=>{return(0,W.jsx)(R.A.Item,{label:m(e.createdAt),children:(0,W.jsxs)("div",{style:{display:"flex",flexDirection:p.md?"row":"column",flexWrap:"wrap",gap:12,cursor:"pointer"},onClick:()=>{l&&l({id:`${e.id}_${e.userId}`,type:"Th\xf4ng tin ti\xeam ph\xf2ng",status:e.status,requestCode:"",createdBy:"",createdAt:"",lastModifiedBy:"",lastUpdateTime:""}),a&&a()},children:[(0,W.jsxs)("div",{style:{flex:2},children:[(0,W.jsx)(P,{strong:!0,children:"M\xe3 ti\xeam ph\xf2ng:"}),(0,W.jsx)("div",{children:e.id})]}),(0,W.jsxs)("div",{style:{flex:2},children:[(0,W.jsx)(P,{strong:!0,children:"Lo\u1ea1i v\u1eafc-xin:"}),(0,W.jsx)("div",{children:e.vaccineType})]}),(0,W.jsxs)("div",{style:{flex:2},children:[(0,W.jsx)(P,{strong:!0,children:"Ng\u01b0\u1eddi nh\u1eadn:"}),(0,W.jsx)("div",{children:e.userId})]}),(0,W.jsxs)("div",{style:{flex:1},children:[(0,W.jsx)(P,{strong:!0,children:"Tr\u1ea1ng th\xe1i:"}),(0,W.jsx)("div",{children:(t=e.status,(0,W.jsx)(g.A,{color:"Active"===t?"green":"orange",style:{borderRadius:"12px"},children:"Active"===t?"\u0110\xe3 ho\xe0n th\xe0nh":"Ch\u01b0a gi\u1ea3i quy\u1ebft"}))})]})]})},`${e.id}-${e.userId}`);var t}))}):(0,W.jsx)("div",{style:{textAlign:"center",padding:20},children:(0,W.jsx)(P,{type:"secondary",children:"Kh\xf4ng c\xf3 l\u1ecbch s\u1eed ti\xeam ph\xf2ng"})})})})},{useBreakpoint:G}=H.Ay,{Text:K}=M.A,U=e=>{let{visible:t,onCancel:i,pet:s,owner:l,onViewViolationDetail:r,setViolationModalVisible:c,setSelectedViolation:x,violationModalVisible:p,onViewVaccinationDetail:m,setSelectedVaccination:u,setVaccinationModalVisible:y}=e;const A=G(),[j,v]=(0,n.useState)(!1),[b,S]=(0,n.useState)([]),[w,I]=(0,n.useState)(!1),[N,T]=(0,n.useState)(!1),[C,k]=(0,n.useState)(s.vaccinationStatus),[B,V]=(0,n.useState)(s.violationStatus),D=(e,t)=>{const i=e,{color:n,text:s}={pet:{male:{color:"#1890ff",text:"\u0110\u1ef1c"},female:{color:"#eb2f96",text:"C\xe1i"}},owner:{male:{color:"#096dd9",text:"Nam"},female:{color:"#c41d7f",text:"N\u1eef"}}}[t][i]||{color:"#d9d9d9",text:"N/A"};return(0,W.jsx)(g.A,{color:n,style:{borderRadius:"12px",textTransform:"capitalize"},children:s})},H=e=>{if(!e||"N/A"===e)return(0,W.jsx)(K,{type:"secondary",children:"N/A"});try{const t=new Date(e);return isNaN(t.getTime())?(0,W.jsx)(K,{type:"secondary",children:"N/A"}):(0,W.jsxs)("div",{className:"date-container",children:[(0,W.jsx)(f.A,{style:{marginRight:8}}),(0,W.jsxs)("span",{children:[t.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}),(0,W.jsx)(K,{type:"secondary",className:"info-time",children:t.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})})]})]})}catch{return(0,W.jsx)(K,{type:"secondary",children:"N/A"})}},M=e=>{if(!e||"N/A"===e)return(0,W.jsx)(K,{type:"secondary",children:"N/A"});try{const t=new Date(e);if(isNaN(t.getTime()))return(0,W.jsx)(K,{type:"secondary",children:"N/A"});const i=t.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}),n=t.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"});return(0,W.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,W.jsxs)("span",{children:[(0,W.jsx)(f.A,{style:{marginRight:6}}),(0,W.jsx)("strong",{children:i})]}),(0,W.jsx)(K,{type:"secondary",style:{marginLeft:24},children:n})]})}catch{return(0,W.jsx)(K,{type:"secondary",children:"N/A"})}},P=async()=>{if(s.id){I(!0);try{const e=(0,q.P)((0,q.rJ)(L.db,"violations"),(0,q._M)("petId","==",s.id)),t=(await(0,q.GG)(e)).docs.map((e=>({id:e.id,violationTime:e.data().violationTime,description:e.data().description,status:e.data().status})));S(t),F(t)}catch(e){console.error("L\u1ed7i khi t\u1ea3i vi ph\u1ea1m:",e),a.Ay.error("Kh\xf4ng th\u1ec3 t\u1ea3i danh s\xe1ch vi ph\u1ea1m")}finally{I(!1)}}},F=async e=>{try{if(!s.id)return;let t="Kh\xf4ng vi ph\u1ea1m";e.some((e=>"Pending"===e.status))&&(t="\u0110ang vi ph\u1ea1m"),B!==t&&(await(0,q.mZ)((0,q.H9)(L.db,"pets",s.id),{violationStatus:t}),V(t))}catch(t){console.error("L\u1ed7i khi c\u1eadp nh\u1eadt tr\u1ea1ng th\xe1i vi ph\u1ea1m:",t),a.Ay.error("C\u1eadp nh\u1eadt tr\u1ea1ng th\xe1i vi ph\u1ea1m th\u1ea5t b\u1ea1i")}};return(0,n.useEffect)((()=>{let e;if(t&&s.id){const t=(0,q.rJ)(L.db,"violations");e=(0,q.aQ)(t,(()=>{P()}))}return()=>{e&&e()}}),[t,s.id]),(0,n.useEffect)((()=>{let e;const i=async e=>{try{const t=await(0,q.GG)((0,q.rJ)(L.db,"vaccinations"));let i=!1,n=!0;t.forEach((t=>{const s=t.data();Array.isArray(s.senderTo)&&s.senderTo.forEach((t=>{var s;const a=(null===(s=t.userId)||void 0===s?void 0:s.split("|"))||[];a[a.length-1]===e&&(i=!0,"Active"!==t.status&&(n=!1))}))}));const a=i&&n?"\u0110\xe3 ti\xeam \u0111\u1ee7":"Ch\u01b0a ti\xeam \u0111\u1ee7";s.vaccinationStatus!==a&&(await(0,q.mZ)((0,q.H9)(L.db,"pets",e),{vaccinationStatus:a}),k(a))}catch(t){console.error("L\u1ed7i khi ki\u1ec3m tra l\u1ecbch s\u1eed ti\xeam ph\xf2ng:",t)}};return t&&s.id&&(i(s.id),e=(0,q.aQ)((0,q.rJ)(L.db,"vaccinations"),(()=>{i(s.id)}))),()=>{e&&e()}}),[t,s.id,s.vaccinationStatus]),(0,n.useEffect)((()=>{k(s.vaccinationStatus)}),[s.vaccinationStatus]),(0,W.jsxs)(h.A,{style:{top:30,maxWidth:"100vw"},styles:{body:{padding:"12px 16px",display:"flex",flexDirection:"column",maxHeight:"75vh",overflowY:"auto"},content:{maxWidth:"95vw"}},className:"pet-info-modal",title:(0,W.jsx)("div",{className:"modal-title",children:(0,W.jsx)("span",{children:"Th\xf4ng tin \u0111\u1ecbnh danh th\xfa c\u01b0ng"})}),open:t,onCancel:i,footer:null,width:A.md?860:"90%",centered:!0,destroyOnClose:!0,children:[(0,W.jsx)($.A,{className:"pet-info-card pet-card",style:{flexShrink:0},title:"Th\xf4ng tin th\xfa c\u01b0ng",cover:s.imageUrl&&(0,W.jsx)(z.A,{src:s.imageUrl,alt:"pet-image",height:200,preview:!1,style:{objectFit:"cover"}}),children:(0,W.jsxs)(R.A,{column:A.md?2:1,size:"middle",labelStyle:{fontWeight:600},contentStyle:{fontWeight:500},children:[(0,W.jsx)(R.A.Item,{label:"T\xean",span:2,children:(0,W.jsx)(K,{strong:!0,className:"info-value",children:s.name||"N/A"})}),(0,W.jsx)(R.A.Item,{label:(0,W.jsx)(W.Fragment,{children:"Lo\xe0i"}),children:s.species}),(0,W.jsx)(R.A.Item,{label:"Gi\u1ed1ng",children:s.breed}),(0,W.jsxs)(R.A.Item,{label:"Tu\u1ed5i",children:[s.age," n\u0103m"]}),(0,W.jsx)(R.A.Item,{label:"Gi\u1edbi t\xednh",children:D(s.gender,"pet")}),(0,W.jsx)(R.A.Item,{label:(0,W.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,W.jsx)("span",{children:"S\u1ee9c kh\u1ecfe"}),(0,W.jsx)(d.Ay,{type:"link",size:"small",style:{padding:0,marginTop:2},children:"Xem th\xeam"})]}),children:(0,W.jsx)("div",{className:"health-status",children:(0,W.jsxs)("div",{children:[(0,W.jsx)("div",{children:s.healthStatus}),s.lastCheckHealthDate&&(0,W.jsx)("div",{className:"last-check",children:H(s.lastCheckHealthDate)})]})})}),(0,W.jsx)(R.A.Item,{label:(0,W.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,W.jsx)("span",{children:"Vi ph\u1ea1m"}),(0,W.jsx)(d.Ay,{type:"link",size:"small",style:{padding:0,marginTop:2},onClick:()=>{v(!0),P()},children:"Xem th\xeam"}),(0,W.jsx)(h.A,{title:`L\u1ecbch s\u1eed vi ph\u1ea1m c\u1ee7a ${s.name}`,open:j,onCancel:()=>v(!1),footer:null,width:A.xs?"95vw":900,style:{top:30,maxWidth:"100vw"},styles:{body:{maxHeight:"70vh",overflowY:"auto",padding:A.xs?"8px 12px":"12px 16px"}},children:(0,W.jsx)(o.A,{spinning:w,children:b.length>0?(0,W.jsx)(R.A,{bordered:!0,column:1,size:A.xs?"small":"middle",labelStyle:{width:A.xs?100:200},children:b.map((e=>{return(0,W.jsx)(R.A.Item,{label:M(e.violationTime),children:(0,W.jsxs)("div",{style:{display:"flex",flexDirection:A.md?"row":"column",gap:12,cursor:"pointer"},onClick:()=>{v(!1),setTimeout((()=>{r(e)}),0)},children:[(0,W.jsxs)("div",{style:{flex:2},children:[(0,W.jsx)(K,{strong:!0,children:"M\xe3 vi ph\u1ea1m:"}),(0,W.jsx)("div",{style:{marginTop:4},children:e.id})]}),(0,W.jsxs)("div",{style:{flex:2},children:[(0,W.jsx)(K,{strong:!0,children:"M\xf4 t\u1ea3:"}),(0,W.jsx)("div",{style:{marginTop:4},children:e.description||"Kh\xf4ng c\xf3 m\xf4 t\u1ea3"})]}),(0,W.jsxs)("div",{style:{flex:1},children:[(0,W.jsx)(K,{strong:!0,children:"Tr\u1ea1ng th\xe1i:"}),(0,W.jsx)("div",{style:{marginTop:4},children:(t=e.status,(0,W.jsx)(g.A,{color:"Active"===t?"green":"orange",style:{borderRadius:"12px"},children:"Active"===t?"\u0110\xe3 ho\xe0n th\xe0nh":"Ch\u01b0a gi\u1ea3i quy\u1ebft"}))})]})]})},e.id);var t}))}):(0,W.jsx)("div",{style:{textAlign:"center",padding:20},children:(0,W.jsx)(K,{type:"secondary",children:"Kh\xf4ng c\xf3 vi ph\u1ea1m n\xe0o"})})})})]}),children:(0,W.jsxs)("div",{className:"\u0110ang vi ph\u1ea1m"===B?"violation-info":"no-violation",children:[B||"Kh\xf4ng c\xf3 th\xf4ng tin",s.lastViolationDate&&(0,W.jsx)("div",{className:"violation-date",children:H(s.lastViolationDate)})]})}),(0,W.jsx)(R.A.Item,{label:(0,W.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,W.jsx)("span",{children:"Ti\xeam ph\xf2ng"}),(0,W.jsx)(d.Ay,{type:"link",size:"small",style:{padding:0,marginTop:2},onClick:()=>T(!0),children:"Xem th\xeam"}),(0,W.jsx)(E,{open:N,onCancel:()=>T(!1),petId:s.id,petName:s.name,onViewVaccinationDetail:m,setSelectedVaccination:u,setVaccinationModalVisible:y})]}),children:(0,W.jsx)(g.A,{color:"\u0110\xe3 ti\xeam \u0111\u1ee7"===C?"#52c41a":"#ffa940",className:"vaccine-tag",children:C})}),(0,W.jsx)(R.A.Item,{label:"L\u1ea7n ti\xeam cu\u1ed1i",children:H(s.lastVaccineDate)})]})}),(0,W.jsx)($.A,{className:"pet-info-card owner-card",style:{marginTop:24},title:"Th\xf4ng tin ch\u1ee7 nu\xf4i",children:(0,W.jsxs)(R.A,{column:A.md?2:1,size:"middle",labelStyle:{fontWeight:600},children:[(0,W.jsx)(R.A.Item,{label:(0,W.jsx)(W.Fragment,{children:"H\u1ecd t\xean"}),span:2,children:(0,W.jsx)(K,{strong:!0,children:l.fullName||"N/A"})}),(0,W.jsx)(R.A.Item,{label:(0,W.jsx)(W.Fragment,{children:"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i"}),children:l.phone}),(0,W.jsx)(R.A.Item,{label:(0,W.jsx)(W.Fragment,{children:"Email"}),children:l.email}),(0,W.jsx)(R.A.Item,{label:"S\u1ed1 c\u0103n c\u01b0\u1edbc",children:l.cccd}),(0,W.jsx)(R.A.Item,{label:"Gi\u1edbi t\xednh",children:D(l.sex?"male":"female","owner")}),(0,W.jsx)(R.A.Item,{label:"Ng\xe0y sinh",children:H(l.birthday)}),(0,W.jsx)(R.A.Item,{label:(0,W.jsx)(W.Fragment,{children:"\u0110\u1ecba ch\u1ec9"}),span:2,children:(0,W.jsx)("div",{className:"address-info",children:l.address})})]})}),(0,W.jsxs)("div",{className:"last-update",children:[(0,W.jsxs)(K,{type:"secondary",children:["C\u1eadp nh\u1eadt l\u1ea7n cu\u1ed1i: ",H(s.lastUpdateTime)]}),(0,W.jsx)("div",{style:{marginTop:8},children:(0,W.jsxs)(K,{type:"secondary",children:["Th\u1ef1c hi\u1ec7n b\u1edfi: ",s.lastModifiedBy]})})]})]})},O={Writing:"\u0110ang ghi th\u1ebb",Processing:"\u0110ang x\u1eed l\xfd",Active:"\u0110\xe3 ho\xe0n th\xe0nh",Pending:"Ch\u01b0a gi\u1ea3i quy\u1ebft"},{Search:J}=s.A,_={setTab:V.sI,setStatus:V.Lx},Y=(0,B.Ng)((e=>({tab:e.request.tab,status:e.request.status,userInfo:e.request.userInfo})),_)((e=>{const[t,i]=(0,n.useState)([]),[B,V]=(0,n.useState)(!1),H=(0,k.Zp)(),[M,$]=(0,n.useState)(""),[P]=D.A.useForm(),[F,E]=(0,n.useState)([]),[G,K]=(0,n.useState)(!1),[_,Y]=(0,n.useState)(null),[Q,X]=(0,n.useState)(!1),[Z,ee]=(0,n.useState)(null),[te,ie]=(0,n.useState)(null),[ne,se]=(0,n.useState)([]),[ae,le]=(0,n.useState)([]),[re,de]=(0,n.useState)([]),[oe,ce]=(0,n.useState)([]),[he,xe]=(0,n.useState)(!1),[pe,ge]=(0,n.useState)(null),[me,ue]=(0,n.useState)(null),[ye,fe]=(0,n.useState)(null),[Ae,je]=(0,n.useState)(!1),[ve,be]=(0,n.useState)(null),[Se,we]=(0,n.useState)([]),[Ie,Ne]=(0,n.useState)(null),[Te,Ce]=(0,n.useState)(null),[ke,Be]=(0,n.useState)(null),[Ve,De]=(0,n.useState)({current:1,pageSize:10,total:0}),Le={id:"",address:"N/A",birthday:"N/A",cccd:"N/A",email:"N/A",fullName:"N/A",phone:"N/A",sex:"N/A",updateAt:"N/A"},qe=async e=>{try{V(!0);const[t,...i]=e.id.split("_"),n=i.join("_"),s=await(0,q.x7)((0,q.H9)(L.db,"vaccinations",t));if(s.exists()){const e=s.data(),t="Pending"===e.status?"Ch\u01b0a gi\u1ea3i quy\u1ebft":"\u0110\xe3 ho\xe0n th\xe0nh",i=(e.senderTo||[]).find((e=>e.userId===n)),a={...e,id:s.id,userId:n,status:(null===i||void 0===i?void 0:i.status)||t,..."\u0110\xe3 ho\xe0n th\xe0nh"===t&&{resolvedAt:(null===i||void 0===i?void 0:i.resolvedAt)||"N/A",resolvedBy:(null===i||void 0===i?void 0:i.resolvedBy)||"N/A"},createdAt:$e(e.createdAt),timeFrom:$e(e.timeFrom),timeTo:$e(e.timeTo),vaccineLocation:e.vaccineLocation,issuingAuthority:e.issuingAuthority,cost:e.cost,notes:e.notes,vaccineType:e.vaccineType||"N/A",senderTo:[i]},[l,r]=n.split("|");if(l){const e=(0,q.P)((0,q.rJ)(L.db,"pets"),(0,q._M)("ownerId","==",l)),t=(await(0,q.GG)(e)).docs.map((e=>({id:e.id,...e.data()})));we(t)}if(r){const e=await(0,q.x7)((0,q.H9)(L.db,"pets",r));if(e.exists()){const t={id:e.id,...e.data()};Ce(t)}else Ce(null)}else Ce(null);if(l){const e=await(0,q.x7)((0,q.H9)(L.db,"owners",l));e.exists()?Be(e.data()):Be(null)}else Be(null);be(a),je(!0)}}catch(t){a.Ay.error("L\u1ed7i khi t\u1ea3i th\xf4ng tin ti\xeam ph\xf2ng")}finally{V(!1)}},He=async e=>{try{V(!0);const t=await(0,q.x7)((0,q.H9)(L.db,"violations",e.id));if(t.exists()){const e=t.data(),i="Pending"===e.status?"Ch\u01b0a gi\u1ea3i quy\u1ebft":"\u0110\xe3 ho\xe0n th\xe0nh",n={...e,id:t.id,status:i,createdAt:$e(e.createdAt),violationTime:$e(e.violationTime),attachments:e.attachments||[]};if(e.petId){const t=await(0,q.x7)((0,q.H9)(L.db,"pets",e.petId));if(t.exists()){const e={id:t.id,...t.data()};if(ue(e),e.ownerId){const t=await(0,q.x7)((0,q.H9)(L.db,"owners",e.ownerId));t.exists()&&fe(t.data())}}}ge(n),xe(!0)}}catch(t){a.Ay.error("L\u1ed7i khi t\u1ea3i th\xf4ng tin vi ph\u1ea1m")}finally{V(!1)}},Me=(e,t)=>{De((i=>({...i,current:e,pageSize:t})))};(0,n.useEffect)((()=>{const e=(0,q.P)((0,q.rJ)(L.db,"violations")),t=(0,q.aQ)(e,(e=>{const t=[];e.forEach((e=>{const i=e.data();let n,s,a;if("Pending"===i.status)n="Ch\u01b0a gi\u1ea3i quy\u1ebft",s=i.handlerBy||"N/A",a=i.updatedAt;else{if("Active"!==i.status)return;n="\u0110\xe3 ho\xe0n th\xe0nh",s=i.resolvedBy||"N/A",a=i.resolvedAt}t.push({id:e.id,type:"Th\xf4ng tin vi ph\u1ea1m",requestCode:e.id,status:n,createdBy:i.notificationBy||"N/A",createdAt:$e(i.createdAt),lastModifiedBy:s,lastUpdateTime:$e(a),description:i.description,notes:i.notes,violationLocation:i.violationLocation,violationTime:i.violationTime,attachments:i.attachments||[]})})),de(t)}),(e=>{a.Ay.error("L\u1ed7i khi t\u1ea3i d\u1eef li\u1ec7u vi ph\u1ea1m: "+e.message)}));return()=>t()}),[]),(0,n.useEffect)((()=>{const e=(0,q.P)((0,q.rJ)(L.db,"vaccinations")),t=(0,q.aQ)(e,(e=>{const t=[];e.forEach((e=>{const i=e.data();(i.senderTo||[]).forEach((n=>{const s="Pending"===n.status?"Ch\u01b0a gi\u1ea3i quy\u1ebft":"\u0110\xe3 ho\xe0n th\xe0nh";t.push({id:`${e.id}_${n.userId}`,type:"Th\xf4ng tin ti\xeam ph\xf2ng",requestCode:`${e.id} | ${n.userId||"N/A"}`,status:s,createdBy:i.notificationBy||"N/A",createdAt:$e(i.createdAt)||"N/A",lastModifiedBy:n.resolvedBy||"",lastUpdateTime:$e(n.resolvedAt)||""})}))})),ce(t)}),(e=>{a.Ay.error("L\u1ed7i khi t\u1ea3i d\u1eef li\u1ec7u ti\xeam ph\xf2ng: "+e.message)}));return()=>t()}),[]),(0,n.useEffect)((()=>{const e=(0,q.P)((0,q.rJ)(L.db,"pets"),(0,q._M)("status","in",["Processing","Active","Writing"])),t=(0,q.aQ)(e,(e=>{const t=[];e.forEach((e=>{const i=e.data();t.push({id:e.id,type:"\u0110\u1ecbnh danh ch\xf3(m\xe8o)",requestCode:e.id,status:"Active"===i.status?"\u0110\xe3 ho\xe0n th\xe0nh":"Writing"===i.status?"\u0110ang ghi th\u1ebb":"\u0110ang x\u1eed l\xfd",createdBy:i.rfidReaderId||"N/A",createdAt:$e(i.createdAt),lastModifiedBy:i.lastModifiedBy||"N/A",lastUpdateTime:$e(i.lastUpdateTime)})})),se(t),V(!1)}),(e=>{a.Ay.error("L\u1ed7i khi t\u1ea3i d\u1eef li\u1ec7u th\xfa c\u01b0ng: "+e.message),V(!1)})),i=(0,q.P)((0,q.rJ)(L.db,"rfidReaderDevices")),n=(0,q.aQ)(i,(e=>{const t=[];e.forEach((e=>{const i=e.data(),n=i.createAt||i.createdAt,s="Active"===i.status?"\u0110\xe3 ho\xe0n th\xe0nh":"\u0110ang x\u1eed l\xfd";t.push({id:e.id,type:"Th\xf4ng tin thi\u1ebft b\u1ecb",requestCode:e.id,status:s,createdBy:e.id,createdAt:$e(n),lastModifiedBy:"",lastUpdateTime:""})})),le(t)}),(e=>{a.Ay.error("L\u1ed7i khi t\u1ea3i d\u1eef li\u1ec7u thi\u1ebft b\u1ecb: "+e.message)}));return()=>{t(),n()}}),[]),(0,n.useEffect)((()=>{const t=e=>{if("N/A"===e)return new Date(0);const[t,i,n]=e.split("/");return new Date(`${n}-${i}-${t}`)},n=(t=>{let i=t;switch(e.tab){case"get-devices":i=i.filter((e=>"Th\xf4ng tin thi\u1ebft b\u1ecb"===e.type));break;case"get-pets":i=i.filter((e=>"\u0110\u1ecbnh danh ch\xf3(m\xe8o)"===e.type));break;case"get-violations":i=i.filter((e=>"Th\xf4ng tin vi ph\u1ea1m"===e.type));break;case"get-vaccines":i=i.filter((e=>"Th\xf4ng tin ti\xeam ph\xf2ng"===e.type))}if(e.status){const t=e.status;O[t]&&(i=i.filter((e=>e.status===O[t])))}return i})([...ne,...ae,...re,...oe].sort(((e,i)=>{const n=t(e.createdAt);return t(i.createdAt).getTime()-n.getTime()})));i(n),E(n),De((e=>({...e,total:n.length})))}),[ne,ae,re,oe,e.tab,e.status]);const $e=e=>{try{var t;const i=(null===e||void 0===e||null===(t=e.toDate)||void 0===t?void 0:t.call(e))||new Date(e);return isNaN(i.getTime())?"N/A":i.toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(i){return"N/A"}},ze=[{title:"Lo\u1ea1i y\xeau c\u1ea7u",dataIndex:"type",key:"type"},{title:"M\xe3 y\xeau c\u1ea7u",dataIndex:"requestCode",key:"requestCode",render:e=>(0,W.jsx)(l.A,{title:(0,W.jsxs)("div",{style:{whiteSpace:"pre-line",textAlign:"center",wordBreak:"break-word",lineHeight:"1.5"},children:[e.replace(/\|/g,"\n"),"  "]}),overlayStyle:{maxWidth:"300px"},children:(0,W.jsxs)("span",{style:{cursor:"help"},onClick:e=>e.stopPropagation(),children:[e.split("|")[0],"          "]})})},{title:"Tr\u1ea1ng th\xe1i",dataIndex:"status",key:"status",render:(e,t)=>{let i="#1890ff";return"\u0110\u1ecbnh danh ch\xf3(m\xe8o)"===t.type?"\u0110ang ghi th\u1ebb"===e?i="#ffa500":"\u0110ang x\u1eed l\xfd"===e?i="#ffd700":"\u0110\xe3 ho\xe0n th\xe0nh"===e&&(i="#52c41a"):"Th\xf4ng tin vi ph\u1ea1m"===t.type?(i="Ch\u01b0a gi\u1ea3i quy\u1ebft"===e?"#ff4d4f":"#52c41a",e="Ch\u01b0a gi\u1ea3i quy\u1ebft"===e?"Ch\u01b0a gi\u1ea3i quy\u1ebft":"\u0110\xe3 ho\xe0n th\xe0nh"):i="Th\xf4ng tin ti\xeam ph\xf2ng"===t.type?"Ch\u01b0a gi\u1ea3i quy\u1ebft"===e?"#ff4d4f":"#52c41a":"\u0110\xe3 ho\xe0n th\xe0nh"===e?"#52c41a":"#ff4d4f",(0,W.jsx)("span",{style:{color:i,fontWeight:500},children:e})}},{title:"Ng\u01b0\u1eddi t\u1ea1o",dataIndex:"createdBy",key:"createdBy"},{title:"Ng\xe0y t\u1ea1o",dataIndex:"createdAt",key:"createdAt",sorter:(e,t)=>{const i=e=>{if("N/A"===e)return new Date(0);const[t,i,n]=e.split("/");return new Date(`${n}-${i}-${t}`)};return i(e.createdAt).getTime()-i(t.createdAt).getTime()}},{title:"Ng\u01b0\u1eddi th\u1ef1c hi\u1ec7n",dataIndex:"lastModifiedBy",key:"executor",render:(e,t)=>{const{type:i,status:n}=t;return"Th\xf4ng tin vi ph\u1ea1m"!==i&&"Th\xf4ng tin ti\xeam ph\xf2ng"!==i||"\u0110\xe3 ho\xe0n th\xe0nh"!==n?"\u0110\u1ecbnh danh ch\xf3(m\xe8o)"===i&&"\u0110ang x\u1eed l\xfd"!==n?e||"N/A":"":e||"N/A"}},{title:"Ng\xe0y th\u1ef1c hi\u1ec7n",dataIndex:"lastUpdateTime",key:"executionDate",render:(e,t)=>{const{type:i,status:n}=t;return"Th\xf4ng tin vi ph\u1ea1m"!==i&&"Th\xf4ng tin ti\xeam ph\xf2ng"!==i||"\u0110\xe3 ho\xe0n th\xe0nh"!==n?"\u0110\u1ecbnh danh ch\xf3(m\xe8o)"===i&&"\u0110ang x\u1eed l\xfd"!==n?e||"N/A":"":e||"N/A"}}];(0,n.useEffect)((()=>{const e=M.toLowerCase(),i=t.filter((t=>{const i=e=>(e||"").toLowerCase();return[i(t.requestCode),i(t.createdBy),i(t.createdAt),i(t.type)].some((t=>t.includes(e)))}));E(i)}),[M,t]);const Re=async()=>{try{const e=await P.validateFields(),t=Number(e.age)||0,i=Math.round(10*t)/10;if(!_)return void a.Ay.error("Kh\xf4ng t\xecm th\u1ea5y th\xfa c\u01b0ng!");const n=()=>{const e=new Date,t=e=>e.toString().padStart(2,"0");return`${e.getFullYear()}-${t(e.getMonth()+1)}-${t(e.getDate())}T${t(e.getHours())}:${t(e.getMinutes())}:${t(e.getSeconds())}`},s=localStorage.getItem("email")||"Unknown",l=n(),r={lastUpdateTime:l,lastModifiedBy:s,...e.healthStatus&&{lastCheckHealthDate:l},...e.vaccinationStatus&&{lastVaccineDate:l},...e.violationStatus&&{lastViolationDate:l}},d={...e,...r,age:i,name:e.name,species:e.species,breed:e.breed,gender:e.gender,healthStatus:e.healthStatus,vaccinationStatus:e.vaccinationStatus,ownerId:e.ownerId,status:"Writing"},o=(0,q.H9)(L.db,"pets",_.id);await(0,q.mZ)(o,d),a.Ay.success("C\u1eadp nh\u1eadt th\xf4ng tin th\xe0nh c\xf4ng!"),K(!1),P.resetFields()}catch(e){console.error("L\u1ed7i khi c\u1eadp nh\u1eadt:",e),a.Ay.error("C\u1eadp nh\u1eadt th\u1ea5t b\u1ea1i! Vui l\xf2ng ki\u1ec3m tra l\u1ea1i th\xf4ng tin.")}},We=()=>{K(!1),P.resetFields()},[Pe,Fe]=(0,n.useState)([]);(0,n.useEffect)((()=>{const e=(0,q.P)((0,q.rJ)(L.db,"owners")),t=(0,q.aQ)(e,(e=>{const t=e.docs.map((e=>({id:e.id,...e.data()})));Fe(t)}));return()=>t()}),[]);const Ee=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"table";if("\u0110\u1ecbnh danh ch\xf3(m\xe8o)"===e.type)if("\u0110\xe3 ho\xe0n th\xe0nh"===e.status){V(!0);try{const i=await(0,q.x7)((0,q.H9)(L.db,"pets",e.id)),n={id:i.id,...i.data()};if(ie(Le),n.ownerId){const e=(await(0,q.x7)((0,q.H9)(L.db,"owners",n.ownerId))).data();ie({...Le,...e})}if(ee(n),X(!0),"notification"===t){const e=(0,q.P)((0,q.rJ)(L.db,"notifications"),(0,q._M)("petId","==",n.id)),t=await(0,q.GG)(e);for(const i of t.docs)await(0,q.mZ)((0,q.H9)(L.db,"notifications",i.id),{message:"Seen"})}}catch(i){a.Ay.error("L\u1ed7i khi t\u1ea3i th\xf4ng tin chi ti\u1ebft")}V(!1)}else"\u0110ang x\u1eed l\xfd"===e.status&&(Y(e),K(!0));else"Th\xf4ng tin thi\u1ebft b\u1ecb"===e.type&&"\u0110\xe3 ho\xe0n th\xe0nh"===e.status?H(`/device/${e.id}`):"Th\xf4ng tin vi ph\u1ea1m"===e.type?He(e):"Th\xf4ng tin ti\xeam ph\xf2ng"===e.type&&qe(e)};return(0,W.jsx)(C.A,{profile:!1,onRowClick:Ee,children:()=>{var e;return(0,W.jsxs)("div",{style:{overflowX:"hidden"},className:"request",children:[(0,W.jsxs)("div",{className:"manage-request-navbar",children:[(0,W.jsx)("div",{className:"manage-request-title",children:"Y\xeau c\u1ea7u v\u1ec1 th\xfa c\u01b0ng"}),(0,W.jsx)(r.A.Compact,{size:"large",children:(0,W.jsx)(J,{className:"search-bar",placeholder:"T\xecm ki\u1ebfm",value:M,onChange:e=>$(e.target.value),onSearch:e=>$(e),enterButton:!0})}),(0,W.jsx)("div",{className:"manage-request-button-navbar",children:(0,W.jsxs)(d.Ay,{style:{marginRight:5,marginLeft:5,backgroundColor:"#5cb85c",color:"white",fontFamily:"Segoe UI",fontWeight:600},onClick:()=>H("/addrequest"),children:[(0,W.jsx)(m.A,{}),(0,W.jsx)("span",{className:"text-create-new",children:"T\u1ea1o m\u1edbi"})]})})]}),(0,W.jsx)("div",{className:"manage-request-content",children:(0,W.jsxs)(o.A,{spinning:B,children:[(0,W.jsx)(c.A,{rowKey:e=>e.id,columns:ze,dataSource:F,pagination:{...Ve,position:["bottomRight"],style:{margin:0,position:"sticky"},showSizeChanger:!0,responsive:!0,pageSizeOptions:["10","20","50","100"],onChange:Me,onShowSizeChange:Me,showTotal:(e,t)=>`${t[0]}-${t[1]} of ${e} items`},bordered:!0,scroll:{x:"max-content"},onRow:e=>({onClick:()=>Ee(e),style:{cursor:"\u0110\u1ecbnh danh ch\xf3(m\xe8o)"!==e.type||"\u0110\xe3 ho\xe0n th\xe0nh"!==e.status&&"\u0110ang x\u1eed l\xfd"!==e.status?"default":"pointer"}})}),Q&&Z&&(0,W.jsx)(U,{visible:Q,onCancel:()=>X(!1),pet:Z,owner:te||Le,onViewViolationDetail:e=>{He({id:e.id,type:"Th\xf4ng tin vi ph\u1ea1m",status:e.status,requestCode:"",createdBy:"",createdAt:"",lastModifiedBy:"",lastUpdateTime:""})},setViolationModalVisible:xe,setSelectedViolation:ge,violationModalVisible:he,onViewVaccinationDetail:e=>{qe({id:e.id,type:"Th\xf4ng tin ti\xeam ph\xf2ng",status:e.status,requestCode:"",createdBy:"",createdAt:"",lastModifiedBy:"",lastUpdateTime:""})},setSelectedVaccination:be,setVaccinationModalVisible:je,vaccinationModalVisible:Ae}),(0,W.jsx)(h.A,{title:"\u0110\u1ecbnh danh th\xf4ng tin th\xfa c\u01b0ng",open:G,onOk:Re,onCancel:We,okText:"L\u01b0u",cancelText:"H\u1ee7y",centered:!0,destroyOnClose:!0,width:window.innerWidth<768?"90%":600,style:{borderRadius:"12px",overflow:"hidden",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.2)",maxHeight:"80vh"},styles:{header:{borderBottom:"1px solid #f0f0f0",padding:"20px 24px",backgroundColor:"#f8f9fa",fontSize:"18px",fontWeight:600,color:"#1d1d1d"},body:{backgroundColor:"#ffffff",maxHeight:"50vh",overflowY:"auto",padding:"16px"},footer:{borderTop:"1px solid #f0f0f0",padding:"16px 24px"}},children:(0,W.jsxs)(D.A,{form:P,layout:"vertical",style:{display:"flex",flexWrap:"wrap",gap:"16px"},children:[(0,W.jsx)("style",{children:"\n                      .ant-form-item-control-input {\n                        min-height: 40px !important;\n                      }\n                      .ant-input-number, .ant-input-number-input-wrap {\n                        height: 40px !important;\n                      }\n                      .ant-select-selector {\n                        height: 40px !important;\n                        align-items: center !important;\n                      }\n                    "}),(0,W.jsx)(D.A.Item,{name:"name",label:(0,W.jsx)("span",{style:{display:"block",marginBottom:"8px",fontWeight:500,color:"#2d3436",fontSize:"14px"},children:"T\xean th\xfa c\u01b0ng"}),rules:[{required:!0,message:"Vui l\xf2ng nh\u1eadp t\xean!"},{max:16,message:"T\xean kh\xf4ng \u0111\u01b0\u1ee3c v\u01b0\u1ee3t qu\xe1 16 k\xfd t\u1ef1!"}],style:{flex:"1 1 100%",marginBottom:0},children:(0,W.jsx)(s.A,{placeholder:"VD: Milu,...",style:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #e0e0e0",fontSize:"14px",lineHeight:"1.5",height:"40px",width:"100%"}})}),(0,W.jsx)(D.A.Item,{name:"species",label:(0,W.jsx)("span",{style:{display:"block",marginBottom:"8px",fontWeight:500,color:"#2d3436",fontSize:"14px"},children:"Lo\xe0i"}),rules:[{required:!0,message:"Vui l\xf2ng ch\u1ecdn lo\xe0i!"},{max:16,message:"Lo\xe0i kh\xf4ng \u0111\u01b0\u1ee3c v\u01b0\u1ee3t qu\xe1 16 k\xfd t\u1ef1!"}],style:{flex:"1 1 48%",marginBottom:0},children:(0,W.jsxs)(x.A,{placeholder:"VD: Ch\xf3, M\xe8o,...",style:{width:"100%",borderRadius:"8px",border:"1px solid #e0e0e0",height:"40px"},dropdownStyle:{borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",padding:"8px 0"},children:[(0,W.jsx)(x.A.Option,{value:"Ch\xf3",style:{padding:"10px 16px",height:"40px",display:"flex",alignItems:"center"},children:"Ch\xf3"}),(0,W.jsx)(x.A.Option,{value:"M\xe8o",style:{padding:"10px 16px",height:"40px",display:"flex",alignItems:"center"},children:"M\xe8o"})]})}),(0,W.jsx)(D.A.Item,{name:"breed",label:(0,W.jsx)("span",{style:{display:"block",marginBottom:"8px",fontWeight:500,color:"#2d3436",fontSize:"14px"},children:"Gi\u1ed1ng"}),style:{flex:"1 1 48%",marginBottom:0},rules:[{required:!0,message:"Vui l\xf2ng nh\u1eadp gi\u1ed1ng!"},{max:16,message:"Gi\u1ed1ng kh\xf4ng \u0111\u01b0\u1ee3c v\u01b0\u1ee3t qu\xe1 16 k\xfd t\u1ef1!"}],children:(0,W.jsx)(s.A,{placeholder:"VD: Poodle,...",style:{padding:"10px 14px",borderRadius:"8px",border:"1px solid #e0e0e0",fontSize:"14px",height:"40px",width:"100%"}})}),(0,W.jsx)(D.A.Item,{required:!0,name:"age",label:(0,W.jsx)("span",{style:{display:"block",marginBottom:"8px",fontWeight:500,color:"#2d3436",fontSize:"14px"},children:"Tu\u1ed5i"}),rules:[{type:"number",min:0,max:50}],style:{flex:"1 1 30%",marginBottom:0},children:(0,W.jsx)("div",{style:{height:"40px"},children:(0,W.jsx)(p.A,{min:0,max:50,placeholder:"VD: 2",style:{width:"100%",borderRadius:"8px",border:"1px solid #e0e0e0",height:"40px"},formatter:e=>`${e}`,onChange:e=>{P.setFieldsValue({age:Number(e)})}})})}),(0,W.jsx)(D.A.Item,{required:!0,name:"gender",label:(0,W.jsx)("span",{style:{display:"block",marginBottom:"8px",fontWeight:500,color:"#2d3436",fontSize:"14px"},children:"Gi\u1edbi t\xednh"}),style:{flex:"1 1 30%",marginBottom:0},children:(0,W.jsxs)(x.A,{placeholder:"Ch\u1ecdn gi\u1edbi t\xednh",style:{width:"100%",borderRadius:"8px",border:"1px solid #e0e0e0",height:"40px"},children:[(0,W.jsx)(x.A.Option,{value:"male",style:{padding:"10px 16px",height:"40px",display:"flex",alignItems:"center"},children:"\u0110\u1ef1c"}),(0,W.jsx)(x.A.Option,{value:"female",style:{padding:"10px 16px",height:"40px",display:"flex",alignItems:"center"},children:"C\xe1i"})]})}),(0,W.jsx)(D.A.Item,{name:"vaccinationStatus",label:(0,W.jsx)("span",{style:{display:"block",marginBottom:"8px",fontWeight:500,color:"#2d3436",fontSize:"14px"},children:"Vaccine"}),style:{flex:"1 1 30%",marginBottom:0},children:(0,W.jsxs)(x.A,{placeholder:"VD: \u0110\xe3 ti\xeam \u0111\u1ee7",style:{width:"100%",borderRadius:"8px",border:"1px solid #e0e0e0",height:"40px"},children:[(0,W.jsx)(x.A.Option,{value:"\u0110\xe3 ti\xeam \u0111\u1ee7",style:{padding:"10px 16px",height:"40px",display:"flex",alignItems:"center"},children:"\u0110\xe3 ti\xeam \u0111\u1ee7"}),(0,W.jsx)(x.A.Option,{value:"Ch\u01b0a ti\xeam \u0111\u1ee7",style:{padding:"10px 16px",height:"40px",display:"flex",alignItems:"center"},children:"Ch\u01b0a ti\xeam \u0111\u1ee7"})]})}),(0,W.jsx)(D.A.Item,{name:"healthStatus",label:(0,W.jsx)("span",{style:{display:"block",marginBottom:"8px",fontWeight:500,color:"#2d3436",fontSize:"14px"},children:"T\xecnh tr\u1ea1ng s\u1ee9c kh\u1ecfe"}),style:{flex:"1 1 100%",marginBottom:0},children:(0,W.jsx)(s.A.TextArea,{rows:3,placeholder:"M\xf4 t\u1ea3 t\xecnh tr\u1ea1ng s\u1ee9c kh\u1ecfe",style:{borderRadius:"8px",border:"1px solid #e0e0e0",resize:"vertical",padding:"10px 14px",fontSize:"14px",minHeight:"40px",width:"100%"}})}),(0,W.jsx)(D.A.Item,{name:"violationStatus",label:(0,W.jsx)("span",{style:{display:"block",marginBottom:"8px",fontWeight:500,color:"#2d3436",fontSize:"14px"},children:"Th\xf4ng tin vi ph\u1ea1m"}),style:{flex:"1 1 100%",marginBottom:0},children:(0,W.jsx)(s.A.TextArea,{rows:3,placeholder:"M\xf4 t\u1ea3 t\xecnh tr\u1ea1ng vi ph\u1ea1m",style:{borderRadius:"8px",border:"1px solid #e0e0e0",resize:"vertical",padding:"10px 14px",fontSize:"14px",minHeight:"40px",width:"100%"}})}),(0,W.jsx)(D.A.Item,{name:"ownerId",label:(0,W.jsx)("span",{style:{display:"block",marginBottom:"8px",fontWeight:500,color:"#2d3436",fontSize:"14px"},children:"Ch\u1ee7 nu\xf4i"}),rules:[{required:!0,message:"Vui l\xf2ng ch\u1ecdn ch\u1ee7 nu\xf4i!"}],style:{flex:"1 1 100%",marginBottom:0},children:(0,W.jsx)(x.A,{showSearch:!0,placeholder:"Ch\u1ecdn ch\u1ee7 nu\xf4i",optionFilterProp:"children",filterOption:(e,t)=>{var i;return(null!==(i=null===t||void 0===t?void 0:t.label)&&void 0!==i?i:"").toLowerCase().includes(e.toLowerCase())},options:Pe.map((e=>({value:e.id,label:`${e.fullName} <${e.email}>`}))),style:{width:"100%",borderRadius:"8px",border:"1px solid #e0e0e0",height:"40px"},dropdownStyle:{borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"}})})]})}),(0,W.jsx)(h.A,{title:(0,W.jsxs)("span",{style:{fontSize:"22px",fontWeight:700,color:"#1890ff",display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(u.A,{})," Chi ti\u1ebft vi ph\u1ea1m"]}),open:he,onCancel:()=>xe(!1),footer:"Ch\u01b0a gi\u1ea3i quy\u1ebft"===(null===pe||void 0===pe?void 0:pe.status)?[(0,W.jsxs)(d.Ay,{type:"primary",style:{backgroundColor:"#52c41a",borderColor:"#52c41a",fontWeight:600,boxShadow:"0 4px 6px rgba(0,0,0,0.1)",borderRadius:"6px",padding:"0 24px",height:"40px",transition:"all 0.3s"},onClick:async()=>{try{const e=new Date,t=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`;await(0,q.mZ)((0,q.H9)(L.db,"violations",pe.id),{status:"Active",resolvedAt:t,resolvedBy:localStorage.getItem("email")||"Unknown"}),a.Ay.success("\u0110\xe3 gi\u1ea3i quy\u1ebft vi ph\u1ea1m th\xe0nh c\xf4ng!"),xe(!1)}catch(e){a.Ay.error("L\u1ed7i khi c\u1eadp nh\u1eadt tr\u1ea1ng th\xe1i vi ph\u1ea1m")}},children:[(0,W.jsx)(y.A,{})," Gi\u1ea3i quy\u1ebft"]},"resolve")]:null,width:window.innerWidth<768?"90%":800,centered:!0,destroyOnClose:!0,style:{borderRadius:"16px",overflow:"hidden",boxShadow:"0 12px 48px rgba(0, 0, 0, 0.2)",maxHeight:"80vh",border:"1px solid #e8e8e8"},styles:{header:{borderBottom:"2px solid #f0f0f0",padding:"20px 32px",backgroundColor:"#fafafa"},body:{maxHeight:"50vh",overflowY:"auto",padding:"32px",fontSize:"15px",background:"linear-gradient(to bottom, #ffffff, #f8fbff)"},footer:{borderTop:"2px solid #f0f0f0",padding:"10px 22px",display:"flex",justifyContent:"flex-end",gap:"16px",backgroundColor:"#fafafa"}},children:pe&&(0,W.jsxs)(R.A,{column:1,bordered:!0,labelStyle:{fontWeight:600,color:"#2d2d2d",backgroundColor:"#f5f5f5",width:"200px",padding:"14px 24px",fontSize:"15px",borderRight:"1px solid #e8e8e8"},contentStyle:{fontSize:"15px",color:"#434343",padding:"16px 24px",backgroundColor:"#ffffff",minHeight:"52px"},children:[(0,W.jsx)(R.A.Item,{label:"M\xe3 vi ph\u1ea1m",children:(0,W.jsxs)(g.A,{color:"blue",style:{fontSize:14,padding:"4px 12px",borderRadius:"4px",fontWeight:500},children:["#",pe.id]})}),(0,W.jsx)(R.A.Item,{label:"Tr\u1ea1ng th\xe1i",children:(0,W.jsx)(g.A,{color:"Ch\u01b0a gi\u1ea3i quy\u1ebft"===pe.status?"orange":"green",style:{fontSize:14,padding:"6px 12px",borderRadius:"20px",fontWeight:500,textTransform:"uppercase"},children:"Ch\u01b0a gi\u1ea3i quy\u1ebft"===pe.status?"Ch\u01b0a gi\u1ea3i quy\u1ebft":"\u0110\xe3 ho\xe0n th\xe0nh"})}),(0,W.jsx)(R.A.Item,{label:"Ng\xe0y t\u1ea1o",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(f.A,{style:{color:"#666"}}),pe.createdAt||"N/A"]})}),(0,W.jsx)(R.A.Item,{label:"Ng\u01b0\u1eddi th\xf4ng b\xe1o",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(A.A,{style:{color:"#666"}}),pe.notificationBy||"N/A"]})}),"\u0110\xe3 ho\xe0n th\xe0nh"===pe.status&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(R.A.Item,{label:"Ng\u01b0\u1eddi gi\u1ea3i quy\u1ebft",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(A.A,{style:{color:"#666"}}),pe.resolvedBy||"N/A"]})}),(0,W.jsx)(R.A.Item,{label:"Th\u1eddi gian gi\u1ea3i quy\u1ebft",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(j.A,{style:{color:"#666"}}),$e(pe.resolvedAt)||"N/A"]})})]}),(0,W.jsxs)(R.A.Item,{label:"Th\xf4ng tin th\xfa c\u01b0ng",children:[me?(0,W.jsxs)("div",{style:{lineHeight:1.6},children:[(0,W.jsxs)("div",{children:[(0,W.jsx)(v.A,{})," T\xean: ",me.name||"N/A"]}),(0,W.jsxs)("div",{children:[(0,W.jsx)(b.A,{})," Lo\xe0i: ",me.species||"N/A"]}),(0,W.jsxs)("div",{children:[(0,W.jsx)(S.A,{})," Gi\u1ed1ng: ",me.breed||"N/A"]})]}):(0,W.jsx)("span",{style:{color:"#8c8c8c"},children:"Kh\xf4ng c\xf3 th\xf4ng tin th\xfa c\u01b0ng"}),(0,W.jsxs)(d.Ay,{type:"primary",ghost:!0,onClick:async()=>{try{V(!0);const e=pe.petId,t=await(0,q.x7)((0,q.H9)(L.db,"pets",e)),i={id:t.id,...t.data()};let n=Le;if(i.ownerId){const e=await(0,q.x7)((0,q.H9)(L.db,"owners",i.ownerId));n={...Le,...e.data()}}ee(i),ie(n),X(!0),xe(!1)}catch(e){a.Ay.error("L\u1ed7i khi t\u1ea3i th\xf4ng tin th\xfa c\u01b0ng")}finally{V(!1)}},style:{borderRadius:"8px",borderColor:"#1890ff",color:"#1890ff",fontWeight:500,display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(w.A,{})," Xem chi ti\u1ebft"]})]}),(0,W.jsx)(R.A.Item,{label:"Th\xf4ng tin ch\u1ee7 nu\xf4i",children:ye?(0,W.jsxs)("div",{style:{lineHeight:1.6},children:[(0,W.jsxs)("div",{children:[(0,W.jsx)(A.A,{})," T\xean: ",ye.fullName||"N/A"]}),(0,W.jsxs)("div",{children:[(0,W.jsx)(I.A,{})," \u0110i\u1ec7n tho\u1ea1i: ",ye.phone||"N/A"]}),(0,W.jsxs)("div",{children:[(0,W.jsx)(N.A,{})," \u0110\u1ecba ch\u1ec9: ",ye.address||"N/A"]})]}):(0,W.jsx)("span",{style:{color:"#8c8c8c"},children:"Kh\xf4ng c\xf3 th\xf4ng tin ch\u1ee7 nu\xf4i"})}),(0,W.jsx)(R.A.Item,{label:"M\xf4 t\u1ea3 vi ph\u1ea1m",children:(0,W.jsx)("div",{style:{backgroundColor:"#fffbe6",padding:"16px",borderRadius:"8px",borderLeft:"4px solid #ffe58f",margin:"8px 0"},children:pe.description||(0,W.jsx)("span",{style:{color:"#bfbfbf"},children:"N/A"})})}),(0,W.jsx)(R.A.Item,{label:"Ghi ch\xfa",children:(0,W.jsx)("div",{style:{padding:"12px",backgroundColor:"#f8f8f8",borderRadius:"6px",fontStyle:"italic"},children:pe.notes||(0,W.jsx)("span",{style:{color:"#bfbfbf"},children:"Kh\xf4ng c\xf3 ghi ch\xfa"})})}),(0,W.jsx)(R.A.Item,{label:"\u0110\u1ecba \u0111i\u1ec3m vi ph\u1ea1m",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(v.A,{style:{color:"#666"}}),pe.violationLocation||"N/A"]})}),(0,W.jsx)(R.A.Item,{label:"Th\u1eddi gian vi ph\u1ea1m",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(j.A,{style:{color:"#666"}}),$e(pe.violationTime)||"N/A"]})}),(0,W.jsx)(R.A.Item,{label:"H\xecnh \u1ea3nh \u0111\xednh k\xe8m",children:(0,W.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(150px, 1fr))",gap:"16px",padding:"8px 0"},children:null!==(e=pe.attachments)&&void 0!==e&&e.length?pe.attachments.map(((e,t)=>(0,W.jsx)(z.A,{width:150,height:150,src:e,style:{borderRadius:"12px",border:"1px solid #f0f0f0",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",transition:"transform 0.2s",cursor:"pointer",objectFit:"cover",aspectRatio:"1"},preview:{maskStyle:{borderRadius:"8px",backgroundColor:"rgba(0,0,0,0.2)"}},alt:`\u1ea2nh vi ph\u1ea1m ${t+1}`},t))):(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"#8c8c8c",fontStyle:"italic"},children:[(0,W.jsx)(T.A,{})," Kh\xf4ng c\xf3 h\xecnh \u1ea3nh"]})})})]})}),(0,W.jsx)(h.A,{title:(0,W.jsxs)("span",{style:{fontSize:"22px",fontWeight:700,color:"#1890ff",display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(u.A,{})," Chi ti\u1ebft ti\xeam ph\xf2ng"]}),open:Ae,onCancel:()=>je(!1),footer:"Pending"===(null===ve||void 0===ve?void 0:ve.status)?[(0,W.jsxs)(d.Ay,{type:"primary",style:{backgroundColor:"#52c41a",borderColor:"#52c41a",fontWeight:600,boxShadow:"0 4px 6px rgba(0,0,0,0.1)",borderRadius:"6px",padding:"0 24px",height:"40px",transition:"all 0.3s"},onClick:async()=>{try{const e=new Date,t=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}T${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}`,i=(0,q.H9)(L.db,"vaccinations",ve.id),n=await(0,q.x7)(i);if(!n.exists())return void a.Ay.error("Kh\xf4ng t\xecm th\u1ea5y d\u1eef li\u1ec7u ti\xeam ph\xf2ng!");const s=(n.data().senderTo||[]).map((e=>e.userId===ve.userId?{...e,status:"Active",resolvedAt:t,resolvedBy:localStorage.getItem("email")||"Unknown"}:e));await(0,q.mZ)(i,{senderTo:s}),a.Ay.success("\u0110\xe3 x\xe1c nh\u1eadn ho\xe0n th\xe0nh ti\xeam ph\xf2ng!"),je(!1)}catch(e){a.Ay.error("L\u1ed7i khi c\u1eadp nh\u1eadt tr\u1ea1ng th\xe1i ti\xeam ph\xf2ng")}},children:[(0,W.jsx)(y.A,{})," X\xe1c nh\u1eadn \u0111\xe3 ti\xeam"]},"confirm-vaccinated")]:null,width:window.innerWidth<768?"90%":800,centered:!0,destroyOnClose:!0,style:{borderRadius:"16px",overflow:"hidden",boxShadow:"0 12px 48px rgba(0, 0, 0, 0.2)",maxHeight:"80vh",border:"1px solid #e8e8e8"},styles:{header:{borderBottom:"2px solid #f0f0f0",padding:"20px 32px",backgroundColor:"#fafafa"},body:{maxHeight:"50vh",overflowY:"auto",padding:"32px",fontSize:"15px",background:"linear-gradient(to bottom, #ffffff, #f8fbff)"},footer:{borderTop:"2px solid #f0f0f0",padding:"10px 22px",display:"flex",justifyContent:"flex-end",gap:"16px",backgroundColor:"#fafafa"}},children:ve&&(0,W.jsxs)(R.A,{column:1,bordered:!0,labelStyle:{fontWeight:600,color:"#2d2d2d",backgroundColor:"#f5f5f5",width:"200px",padding:"14px 24px",fontSize:"15px",borderRight:"1px solid #e8e8e8"},contentStyle:{fontSize:"15px",color:"#434343",padding:"16px 24px",backgroundColor:"#ffffff",minHeight:"52px"},children:[(0,W.jsx)(R.A.Item,{label:"M\xe3 ti\xeam ph\xf2ng",children:(0,W.jsxs)(g.A,{color:"blue",style:{fontSize:14,padding:"4px 12px",borderRadius:"4px",fontWeight:500},children:["#",ve.id]})}),(0,W.jsx)(R.A.Item,{label:"Tr\u1ea1ng th\xe1i",children:(0,W.jsx)(g.A,{color:"Pending"===ve.status?"orange":"green",style:{fontSize:14,padding:"6px 12px",borderRadius:"20px",fontWeight:500,textTransform:"uppercase"},children:"Pending"===ve.status?"Ch\u01b0a gi\u1ea3i quy\u1ebft":"\u0110\xe3 ho\xe0n th\xe0nh"})}),(0,W.jsx)(R.A.Item,{label:"Ng\xe0y t\u1ea1o",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(f.A,{style:{color:"#666"}}),ve.createdAt||"N/A"]})}),(0,W.jsx)(R.A.Item,{label:"Ng\u01b0\u1eddi th\xf4ng b\xe1o",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(A.A,{style:{color:"#666"}}),ve.notificationBy||"N/A"]})}),"Active"===ve.status&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(R.A.Item,{label:"Ng\u01b0\u1eddi x\xe1c nh\u1eadn",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(A.A,{style:{color:"#666"}}),ve.resolvedBy||"N/A"]})}),(0,W.jsx)(R.A.Item,{label:"Th\u1eddi gian x\xe1c nh\u1eadn",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(j.A,{style:{color:"#666"}}),$e(ve.resolvedAt)||"N/A"]})})]}),(0,W.jsx)(R.A.Item,{label:"Th\xf4ng tin th\xfa c\u01b0ng",children:Te?(0,W.jsxs)("div",{style:{lineHeight:1.6},children:[(0,W.jsxs)("div",{children:[(0,W.jsx)(v.A,{})," T\xean: ",Te.name||"N/A"]}),(0,W.jsxs)("div",{children:[(0,W.jsx)(b.A,{})," Lo\xe0i: ",Te.species||"N/A"]}),(0,W.jsxs)("div",{children:[(0,W.jsx)(S.A,{})," Gi\u1ed1ng: ",Te.breed||"N/A"]}),(0,W.jsxs)(d.Ay,{type:"primary",ghost:!0,onClick:async()=>{try{V(!0);const e=Te.id,t=await(0,q.x7)((0,q.H9)(L.db,"pets",e)),i={id:t.id,...t.data()};let n=Le;if(i.ownerId){const e=await(0,q.x7)((0,q.H9)(L.db,"owners",i.ownerId));n={...Le,...e.data()}}ee(i),ie(n),X(!0),je(!1)}catch(e){a.Ay.error("L\u1ed7i khi t\u1ea3i th\xf4ng tin th\xfa c\u01b0ng")}finally{V(!1)}},style:{marginTop:8,borderRadius:8,borderColor:"#1890ff",color:"#1890ff",fontWeight:500,display:"flex",alignItems:"center",gap:8},children:[(0,W.jsx)(w.A,{})," Xem chi ti\u1ebft"]})]}):(0,W.jsx)("span",{style:{color:"#8c8c8c",fontStyle:"italic"},children:"Kh\xf4ng c\xf3 th\xf4ng tin th\xfa c\u01b0ng"})}),(0,W.jsx)(R.A.Item,{label:"Th\xf4ng tin ch\u1ee7 nu\xf4i",children:ke?(0,W.jsxs)("div",{style:{lineHeight:1.6},children:[(0,W.jsxs)("div",{children:[(0,W.jsx)(A.A,{})," T\xean: ",ke.fullName||"N/A"]}),(0,W.jsxs)("div",{children:[(0,W.jsx)(I.A,{})," \u0110i\u1ec7n tho\u1ea1i: ",ke.phone||"N/A"]}),(0,W.jsxs)("div",{children:[(0,W.jsx)(N.A,{})," \u0110\u1ecba ch\u1ec9: ",ke.address||"N/A"]})]}):(0,W.jsx)("span",{style:{color:"#8c8c8c"},children:"Kh\xf4ng c\xf3 th\xf4ng tin ch\u1ee7 nu\xf4i"})}),(0,W.jsx)(R.A.Item,{label:"Th\u1eddi gian (t\u1eeb ng\xe0y)",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(j.A,{style:{color:"#666"}}),ve.timeFrom||"N/A"]})}),(0,W.jsx)(R.A.Item,{label:"Th\u1eddi gian (\u0111\u1ebfn ng\xe0y)",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(j.A,{style:{color:"#666"}}),ve.timeTo||"N/A"]})}),(0,W.jsx)(R.A.Item,{label:"\u0110\u1ecba \u0111i\u1ec3m ti\xeam",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(v.A,{style:{color:"#666"}}),ve.vaccineLocation||"N/A"]})}),(0,W.jsx)(R.A.Item,{label:"C\u01a1 quan ban h\xe0nh",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(N.A,{style:{color:"#666"}}),ve.issuingAuthority||"N/A"]})}),(0,W.jsx)(R.A.Item,{label:"Lo\u1ea1i vaccine",children:(0,W.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,W.jsx)(b.A,{style:{color:"#666"}}),ve.vaccineType||"Kh\xf4ng c\xf3"]})}),(0,W.jsx)(R.A.Item,{label:"Chi ph\xed",children:ve.cost?`${ve.cost} VN\u0110`:"Kh\xf4ng c\xf3"}),(0,W.jsx)(R.A.Item,{label:"Ghi ch\xfa",children:(0,W.jsx)("div",{style:{padding:"12px",backgroundColor:"#f8f8f8",borderRadius:"6px",fontStyle:"italic"},children:ve.notes||(0,W.jsx)("span",{style:{color:"#bfbfbf"},children:"Kh\xf4ng c\xf3 ghi ch\xfa"})})})]})})]})})]})}})}))}}]);
//# sourceMappingURL=440.09e640be.chunk.js.map